@startuml OTAMS_Class_Diagram

title OTAMS (Online Tutor and Student Management System) - Class Diagram

' Enumerations
enum UserRole {
    ADMIN
    TUTOR
    STUDENT
}

enum UserStatus {
    ACTIVE
    PENDING
    SUSPENDED
}

' Core Data Classes
abstract class User {
    - username: String
    - password: String
    - role: UserRole
    - status: UserStatus
    + User(username: String, password: String)
    + getUsername(): String
    + getPassword(): String
    + getRole(): UserRole
    + setRole(role: UserRole): void
    + getStatus(): UserStatus
    + setStatus(status: UserStatus): void
}

class Admin {
    + Admin(username: String, password: String)
    + accept(): void
    + reject(): void
}

class Client {
    - First_Name: String
    - Last_Name: String
    - Phone_Number: String
    - Future_Session: String
    - Past_Session: String
    + Client(Email: String, Password: String, First_Name: String, Last_Name: String, Phone_Number: String, Future_Session: String, Past_Session: String)
    + Client(Email: String, Password: String, First_Name: String, Last_Name: String, Phone_Number: String)
    + getFirst_Name(): String
    + setFirst_Name(First_Name: String): void
    + getLast_Name(): String
    + setLast_Name(Last_Name: String): void
    + getPhone_Number(): String
    + setPhone_Number(Phone_Number: String): void
    + getFuture_Session(): String
    + setFuture_Session(Future_Session: String): void
    + getPast_Session(): String
    + setPast_Session(Past_Session: String): void
    + accept(): void
    + reject(): void
}

class Student {
    - Program_Of_Study: String
    + Student(Email: String, Password: String, First_Name: String, Last_Name: String, Phone_Number: String, Future_Session: String, Past_Session: String, Program_Of_Study: String)
    + Student(Email: String, Password: String, First_Name: String, Last_Name: String, Phone_Number: String, Program_Of_Study: String)
    + getProgram_Of_Study(): String
    + setProgram_Of_Study(Program_Of_Study: String): void
}

class Tutor {
    - Highest_Degree: String
    - Courses_Offered: String
    + Tutor(Email: String, Password: String, First_Name: String, Last_Name: String, Phone_Number: String, Future_Session: String, Past_Session: String, Highest_Degree: String, Courses_Offered: String)
    + Tutor(Email: String, Password: String, First_Name: String, Last_Name: String, Phone_Number: String, Highest_Degree: String, Courses_Offered: String)
    + getHighest_Degree(): String
    + setHighest_Degree(Highest_Degree: String): void
    + getCourses_Offered(): String
    + setCourses_Offered(Courses_Offered: String): void
}

' UI Fragments
class LoginFragment <<Fragment>> {
    - loginViewModel: LoginViewModel
    - binding: FragmentLoginBinding
    + onCreateView(inflater: LayoutInflater, container: ViewGroup, savedInstanceState: Bundle): View
    + onViewCreated(view: View, savedInstanceState: Bundle): void
    - checkUserStatusAndNavigate(view: View, email: String): void
    - updateUiWithUser(model: LoggedInUserView): void
    - showLoginFailed(errorString: Integer): void
    + onDestroyView(): void
}

class fragment_signup <<Fragment>> {
    - binding: FragmentSignupBinding
    + onCreateView(inflater: LayoutInflater, container: ViewGroup, savedInstanceState: Bundle): View
    + onViewCreated(view: View, savedInstanceState: Bundle): void
}

class fragment_homepage <<Fragment>> {
    + onCreateView(inflater: LayoutInflater, container: ViewGroup, savedInstanceState: Bundle): View
    + onViewCreated(view: View, savedInstanceState: Bundle): void
}

class fragment_admin <<Fragment>> {
    - binding: FragmentAdminBinding
    - userAdapter: UserAdapter
    - userList: List<Map<String, Object>>
    + onCreateView(inflater: LayoutInflater, container: ViewGroup, savedInstanceState: Bundle): View
    + onViewCreated(view: View, savedInstanceState: Bundle): void
    - loadUsers(): void
    - updateUserStatus(userId: String, newStatus: String): void
}

' ViewModel and Related Classes
class LoginViewModel {
    - loginFormState: MutableLiveData<LoginFormState>
    - loginResult: MutableLiveData<LoginResult>
    + getLoginFormState(): LiveData<LoginFormState>
    + getLoginResult(): LiveData<LoginResult>
    + login(username: String, password: String): void
    + loginDataChanged(username: String, password: String): void
    + clearLoginResult(): void
}

class LoginViewModelFactory {
    + create(modelClass: Class<T>): T
}

class LoginFormState {
    - usernameError: Integer
    - passwordError: Integer
    - isDataValid: boolean
    + getUsernameError(): Integer
    + getPasswordError(): Integer
    + isDataValid(): boolean
}

class LoginResult {
    - success: LoggedInUserView
    - error: Integer
    + getSuccess(): LoggedInUserView
    + getError(): Integer
}

class LoggedInUserView {
    - displayName: String
    + LoggedInUserView(displayName: String)
    + getDisplayName(): String
}

' Firebase and Data Sources
class RegisterDataSource {
    + register(username: String, password: String): Result<User>
}

class Result<T> {
    {abstract}
}

' Relationships - Inheritance
User <|-- Admin
User <|-- Client
Client <|-- Student
Client <|-- Tutor

' Relationships - Composition/Association
User --> UserRole : has
User --> UserStatus : has

LoginFragment --> LoginViewModel : uses
LoginViewModel --> LoginFormState : manages
LoginViewModel --> LoginResult : manages
LoginResult --> LoggedInUserView : contains

LoginViewModel ..> LoginViewModelFactory : created by

fragment_signup ..> Student : creates
fragment_signup ..> Tutor : creates
fragment_signup ..> RegisterDataSource : uses

LoginFragment ..> FirebaseAuth : authenticates with
fragment_homepage ..> FirebaseAuth : checks
fragment_homepage ..> FirebaseFirestore : queries
fragment_admin ..> FirebaseFirestore : manages users

' External Dependencies
class FirebaseAuth <<external>> {
    + signInWithEmailAndPassword(email: String, password: String): Task
    + getCurrentUser(): FirebaseUser
    + signOut(): void
}

class FirebaseFirestore <<external>> {
    + collection(name: String): CollectionReference
    + getInstance(): FirebaseFirestore
}

' Notes
note right of User
  Base class for all user types.
  Contains authentication credentials
  and user state information.
end note

note right of Client
  Extended user with personal
  information and session tracking.
  Inherits from User.
end note

note right of Student
  Student user with program of study.
  Registers with PENDING status and
  requires admin approval.
end note

note right of Tutor
  Tutor user with credentials
  (degree and courses).
  Registers with PENDING status and
  requires admin approval.
end note

note right of Admin
  Administrator user with approval
  privileges. Can accept/reject
  registration requests.
end note

note left of fragment_admin
  Admin panel for managing
  user registration requests.
  Displays all PENDING users
  and allows approval/rejection.
end note

note left of LoginFragment
  Handles user authentication
  and status validation.
  Blocks PENDING/SUSPENDED users.
end note

note left of fragment_homepage
  Routes users based on role:
  - ADMIN → admin panel
  - STUDENT/TUTOR → homepage
  Validates ACTIVE status.
end note

@enduml
